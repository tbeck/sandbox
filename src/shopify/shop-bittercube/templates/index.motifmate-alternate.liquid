{% layout none %}{%- assign parentposition = 0 -%}{%- assign counter = 0 -%}{%- assign count = 0 -%}{% for linklist in linklists %}{%- assign counter = counter | plus: 1 -%}{% endfor %}{"link_lists": [{% for linklist in linklists %}{%- assign count = count | plus: 1 -%}{"id": "{{ count }}","title": "{{ linklist.title | replace: '"', '\"' }}","handle": "{{ linklist.handle }}","default": true,"links": [{%- assign position = 0 -%}{%- assign linksize = linklist.links | size -%}{% for link in linklist.links %}{%- assign subject_id = link.url  -%}{%- assign subject_params = null  -%}{% if link.type == "product_link" %}{%- assign subject_id = subject_id | replace: "/products/", "" -%}{% elsif link.type == "page_link" %}{%- assign subject_id = subject_id | replace: "/pages/", "" -%}{% elsif link.type == "blog_link" %}{%- assign subject_id = subject_id | replace: "/blogs/", "" -%}{% elsif link.type == "collection_link" %}{%- assign subject_id = subject_id | replace: "/collections/", "" -%}{%- assign params = subject_id | split: "/" -%}{% if params.size > 1 %}{%- assign subject_id = params.first -%}{%- assign subject_params = params.last | replace: "+", ", " -%}{% endif %}{% endif %}{%- assign position = position | plus: 1 -%}{"id": "{{ position }}","title": "{{ link.title | replace: '"', '\"' }}","subject": "{{ subject_id }}","subject_id": "{{ link.object.id }}","link_list_id": "{{ count }}","position": {{ position }},"subject_params": "{{ subject_params }}","link_type": "{{ link.type | replace: "_link", "" }}"}{% if position > 0 and position < linksize %},{% endif %}{% endfor %}]}{%- assign parentposition = parentposition | plus: 1 -%}{% if parentposition > 0 and parentposition < counter %},{% endif %}{% endfor %}]}